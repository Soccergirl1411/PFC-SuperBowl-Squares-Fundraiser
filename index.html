<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PFC 2009 Boys | Super Bowl LX Fundraiser</title>
    <style>
        :root {
            --pfc-green: #00843D;
            --sb-gradient: linear-gradient(135deg, #6e2da8 0%, #b02e91 50%, #e3a61b 100%);
            --pats-navy: #002244; --pats-red: #C60C30;
            --hawks-green: #69BE28; --hawks-navy: #002244;
            --bg: #f8fafc;
        }

        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); margin: 0; color: #1e293b; text-align: center; overflow-x: hidden; }
        .container { max-width: 1100px; margin: 10px auto; padding: 0 10px; }

        /* Modern UI Header */
        .header-card { background: white; padding: 1rem; border-radius: 24px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 1.5rem; }
        .sb-title { background: var(--sb-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 2rem; font-weight: 800; margin: 0; text-transform: uppercase; letter-spacing: -1px; }
        .pfc-label { color: var(--pfc-green); font-weight: 700; letter-spacing: 2px; font-size: 1rem; margin-top: 5px; }

        /* The Football Arena Wrapper - Handles Mobile Scrolling */
        .arena-scroll-container {
            width: 100%;
            overflow-x: auto; /* This allows side-scrolling on mobile */
            -webkit-overflow-scrolling: touch;
            padding-bottom: 20px;
            display: flex;
            justify-content: flex-start; /* Keeps grid left-aligned so user can see side labels */
        }

        .arena { 
            background: white; 
            padding: 15px; 
            border-radius: 20px; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.05); 
            display: inline-block; 
            position: relative;
            margin: 0 auto;
        }

        .team-top { background: var(--pats-navy); color: white; padding: 8px; font-weight: 700; border-radius: 8px 8px 0 0; border-bottom: 4px solid var(--pats-red); margin-left: 44px; font-size: 0.8rem; letter-spacing: 1px; }
        .side-content { display: flex; }
        .team-side { background: var(--hawks-navy); color: white; writing-mode: vertical-rl; transform: rotate(180deg); padding: 8px; font-weight: 700; border-radius: 0 8px 8px 0; border-right: 4px solid var(--hawks-green); font-size: 0.8rem; letter-spacing: 1px; }

        /* The Grid - Responsive Squares */
        .grid { display: grid; grid-template-columns: repeat(11, 1fr); gap: 4px; padding: 5px; background: #f1f5f9; }
        
        /* Desktop Size */
        .sq { width: 65px; height: 65px; background: white; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600; border-radius: 6px; cursor: pointer; border: 1px solid #e2e8f0; transition: 0.15s; overflow: hidden; padding: 4px; text-align: center; line-height: 1.1; box-sizing: border-box; }
        
        .sq:hover:not(.taken) { border-color: var(--pfc-green); background: #f0fff4; transform: scale(1.05); z-index: 10; }
        
        .head-sq { background: #0f172a; color: white; cursor: default; font-size: 12px; }
        .num-sq { background: #f8fafc; color: #0f172a; font-size: 20px; font-weight: 800; cursor: default; }
        .taken { background: #e8f5e9; color: var(--pfc-green); border-color: #c8e6c9; cursor: not-allowed; font-weight: 700; }
        .selected { background: var(--pfc-green) !important; color: white !important; border-color: #004d23 !important; }

        /* Checkout Form Pill */
        #selection-form { 
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: white; padding: 15px; border-radius: 30px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.3); display: none; border: 2px solid var(--pfc-green); 
            z-index: 1000; align-items: center; gap: 10px; width: auto; max-width: 90%;
        }
        
        input { padding: 10px 15px; border-radius: 20px; border: 1px solid #ddd; outline: none; width: 140px; font-size: 0.9rem; }
        .btn-submit { background: var(--pfc-green); color: white; padding: 10px 20px; border-radius: 20px; border: none; font-weight: 700; cursor: pointer; transition: 0.2s; white-space: nowrap; }
        
        /* Loading Overlay */
        .loading-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.9); z-index:2000; justify-content:center; align-items:center; flex-direction: column; font-weight:bold; color:var(--pfc-green); }

        /* Mobile Breakpoint Adjustments */
        @media (max-width: 600px) { 
            .sb-title { font-size: 1.5rem; }
            .sq { width: 50px; height: 50px; font-size: 8px; } 
            .num-sq { font-size: 16px; } 
            #selection-form { flex-direction: column; border-radius: 20px; width: 85%; }
            input { width: 100%; box-sizing: border-box; }
            .btn-submit { width: 100%; }
        }
    </style>
</head>
<body>

<div id="loader" class="loading-overlay">
    <div style="font-size: 2.5rem; margin-bottom: 10px;">âš½</div>
    <span>Syncing with PFC Sheet...</span>
</div>

<div class="container">
    <div class="header-card">
        <h1 class="sb-title">Super Bowl Squares</h1>
        <div class="pfc-label">PFC 2009 BOYS</div>
        <p style="color: #64748b; font-size: 0.85rem; margin-top:10px; line-height: 1.4;">
            <b>$20 per square</b><br>e-Transfer: <b>PFCBOYS09@GMAIL.COM</b>
        </p>
    </div>

    <div class="arena-scroll-container">
        <div class="arena">
            <div class="team-top">NEW ENGLAND PATRIOTS (AFC)</div>
            <div class="side-content">
                <div class="team-side">SEATTLE SEAHAWKS (NFC)</div>
                <div id="game-board" class="grid"></div>
            </div>
        </div>
    </div>

    <div id="selection-form">
        <span id="count-label" style="font-weight:800; color:var(--pfc-green);">0 Selected</span>
        <input type="text" id="parent-name" placeholder="Full Name">
        <input type="email" id="parent-email" placeholder="Email Address">
        <button class="btn-submit" onclick="submitSelection()">Check Out</button>
    </div>

    <div style="margin-top: 50px; padding-bottom: 50px;">
        <button onclick="adminMenu()" style="opacity:0.03; background:none; border:none; cursor:pointer;">Admin</button>
    </div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzHUIWFce4Xb1HI3nW1toacZiEI4HK6nfsph5oZovGslcdhkOZMaVj_vcT8rPGrE6qd/exec";
    let selectedSquares = [];

    async function loadBoard() {
        try {
            const response = await fetch(SCRIPT_URL + "?cb=" + Date.now());
            const sheetData = await response.json();
            renderBoard(sheetData);
        } catch (e) { 
            setTimeout(loadBoard, 2500); 
        }
    }

    function renderBoard(sheetData) {
        const board = document.getElementById('game-board');
        board.innerHTML = "";
        let taken = {};
        sheetData.forEach(row => { if(row[0]) taken[row[0]] = row[1]; });

        for (let i = 0; i < 121; i++) {
            const d = document.createElement('div');
            d.className = 'sq';
            if (i === 0) { d.innerHTML = "ðŸˆ"; d.classList.add('head-sq'); }
            else if (i < 11 || i % 11 === 0) { 
                const savedNum = localStorage.getItem('axis-' + i);
                d.innerText = savedNum ? savedNum : "?";
                d.classList.add('num-sq'); 
                d.id = `axis-${i}`; 
            }
            else {
                if (taken[i]) { 
                    d.innerText = taken[i]; d.classList.add('taken'); 
                } else { 
                    d.onclick = () => toggleSquare(i, d); 
                }
            }
            board.appendChild(d);
        }
        document.getElementById('loader').style.display = 'none';
    }

    function toggleSquare(id, element) {
        if (selectedSquares.includes(id)) {
            selectedSquares = selectedSquares.filter(s => s !== id);
            element.classList.remove('selected');
        } else {
            selectedSquares.push(id);
            element.classList.add('selected');
        }
        const form = document.getElementById('selection-form');
        form.style.display = selectedSquares.length > 0 ? 'flex' : 'none';
        document.getElementById('count-label').innerText = `${selectedSquares.length} Selected`;
    }

    async function submitSelection() {
        const name = document.getElementById('parent-name').value.trim();
        const email = document.getElementById('parent-email').value.trim();
        if (!name || !email) return alert("Please enter name and email.");

        document.getElementById('loader').style.display = 'flex';
        document.getElementById('loader').querySelector('span').innerText = "Registering Squares...";
        document.getElementById('selection-form').style.display = 'none';

        for (let id of selectedSquares) {
            try {
                await fetch(SCRIPT_URL, { 
                    method: "POST", 
                    mode: "no-cors", 
                    headers: { "Content-Type": "text/plain" },
                    body: JSON.stringify({ squareId: id, name: name, email: email }) 
                });
            } catch (e) { console.error(e); }
        }
        
        const total = selectedSquares.length * 20;
        selectedSquares = [];
        document.getElementById('parent-name').value = "";
        document.getElementById('parent-email').value = "";
        
        setTimeout(() => {
            loadBoard();
            alert("Squares Reserved!\n\nPlease e-transfer $" + total + " to PFCBOYS09@GMAIL.COM");
        }, 2000);
    }

    function adminMenu() {
        const pin = prompt("Admin PIN:");
        if (pin !== "Soccer2009") return;
        const action = (prompt("Type 'DRAW' or 'RESET':") || "").toUpperCase();
        if (action === "DRAW") {
            const r1 = [0,1,2,3,4,5,6,7,8,9].sort(() => Math.random() - 0.5);
            const r2 = [0,1,2,3,4,5,6,7,8,9].sort(() => Math.random() - 0.5);
            for (let i = 1; i < 11; i++) localStorage.setItem(`axis-${i}`, r1[i-1]);
            for (let i = 1; i < 11; i++) localStorage.setItem(`axis-${i*11}`, r2[i-1]);
            loadBoard();
        } else if (action === "RESET") {
            for (let i = 0; i < 121; i++) localStorage.removeItem(`axis-${i}`);
            loadBoard();
        }
    }

    loadBoard();
</script>
</body>
</html>